# .env.example — commit this file; NEVER commit .env (it may contain secrets)
# Copy to .env and fill in your values before running the server.

# ── Transport ──────────────────────────────────────────────────────────────────
MCP_TRANSPORT=stdio            # stdio | sse
MCP_HOST=127.0.0.1             # SSE only — bind address
MCP_PORT=8000                  # SSE only — listen port

# ── LanceDB ────────────────────────────────────────────────────────────────────
# Set this to match your deployment mode:
#   Local dev:      ~/.mcpvectordb/lancedb
#   k3s PVC:        /data/lancedb
#   Remote/S3:      s3://bucket/path  (LanceDB supports s3:// URIs)
LANCEDB_URI=~/.mcpvectordb/lancedb
LANCEDB_TABLE_NAME=documents
DEFAULT_LIBRARY=default            # fallback library name when not specified in tool call

# ── Embedding ──────────────────────────────────────────────────────────────────
# WARNING: changing EMBEDDING_MODEL requires a full re-index — vectors from different
# models are incompatible and search will silently return garbage.
EMBEDDING_MODEL=nomic-embed-text-v1.5
EMBEDDING_BATCH_SIZE=32

# ── Search ─────────────────────────────────────────────────────────────────────
HYBRID_SEARCH_ENABLED=true   # Combine BM25 + vector search; disable for pure-vector mode
SEARCH_REFINE_FACTOR=10      # Re-score top N*refine_factor ANN candidates for better recall

# ── Chunking ───────────────────────────────────────────────────────────────────
CHUNK_SIZE_TOKENS=512
CHUNK_OVERLAP_TOKENS=64
CHUNK_MIN_TOKENS=50

# ── Upload ─────────────────────────────────────────────────────────────────────
MAX_UPLOAD_BYTES=52428800          # 50 MB — maximum size for POST /upload multipart files

# ── Security ───────────────────────────────────────────────────────────────────
# Extra allowed Host headers for DNS rebinding protection (streamable-http only).
# Add your reverse-proxy / tunnel hostname when running behind tailscale serve,
# nginx, cloudflared, etc. Comma-separated or JSON array.
# ALLOWED_HOSTS=pluto.tailbcd62a.ts.net
# ALLOWED_HOSTS=host1.example.com,host2.example.com

# ── URL fetching ───────────────────────────────────────────────────────────────
HTTP_TIMEOUT_SECONDS=10
HTTP_USER_AGENT=mcpvectordb/1.0

# ── Logging ────────────────────────────────────────────────────────────────────
LOG_LEVEL=INFO                     # DEBUG | INFO | WARNING | ERROR
# In stdio mode ALL output must go to stderr or a file — never stdout.
# LOG_FILE=~/.mcpvectordb/server.log  # uncomment to log to file instead of stderr
